---
title: "p8105_hw5_hl3859"
author: "Hanrui Li"
date: "2024-11-13"
output: github_document
---

# Problem 1

```{r}
has_duplicate = function(n) {
  bdays = sample(1:365, n, replace = TRUE) 
  return(any(duplicated(bdays))) 
}

simulate_probs = function(trials = 10000, max_size = 50) {
  probs = numeric(max_size - 1)
  
  for (n in 2:max_size) {
    dup_count = sum(replicate(trials, has_duplicate(n)))
    probs[n - 1] = dup_count / trials
  }
  
  return(probs)
}

probs = simulate_probs()

group_sizes = 2:50
plot(group_sizes, probs, type = "b", 
     xlab = "Group Size (n)", 
     ylab = "Probability of Shared Birthday",
     main = "Probability of at Least Two People Sharing a Birthday",
     pch = 16, col = "blue")
abline(h = 0.5, col = "red", lty = 2)
```

